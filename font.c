#include "font.h"
#include "harvey_platform.h"


static const uint64_t Uni2VGA16[190] = {
	0x0000000000000000, 0x0000000000000000, 0x18183c3c3c180000, 0x0000000018180018,
	0x0000002466666600, 0x0000000000000000, 0x6c6cfe6c6c000000, 0x000000006c6cfe6c,
	0x067cc0c2c67c1818, 0x000018187cc68606, 0x180cc6c200000000, 0x0000000086c66030,
	0xdc76386c6c380000, 0x0000000076cccccc, 0x0000002030303000, 0x0000000000000000,
	0x30303030180c0000, 0x000000000c183030, 0x0c0c0c0c18300000, 0x0000000030180c0c,
	0xff3c660000000000, 0x000000000000663c, 0x7e18180000000000, 0x0000000000001818,
	0x0000000000000000, 0x0000003018181800, 0xfe00000000000000, 0x0000000000000000,
	0x0000000000000000, 0x0000000018180000, 0x180c060200000000, 0x0000000080c06030,
	0xd6d6c6c66c380000, 0x00000000386cc6c6, 0x1818187838180000, 0x000000007e181818,
	0x30180c06c67c0000, 0x00000000fec6c060, 0x063c0606c67c0000, 0x000000007cc60606,
	0xfecc6c3c1c0c0000, 0x000000001e0c0c0c, 0x06fcc0c0c0fe0000, 0x000000007cc60606,
	0xc6fcc0c060380000, 0x000000007cc6c6c6, 0x180c0606c6fe0000, 0x0000000030303030,
	0xc67cc6c6c67c0000, 0x000000007cc6c6c6, 0x067ec6c6c67c0000, 0x00000000780c0606,
	0x0000181800000000, 0x0000000000181800, 0x0000181800000000, 0x0000000030181800,
	0x6030180c06000000, 0x00000000060c1830, 0x00007e0000000000, 0x000000000000007e,
	0x060c183060000000, 0x000000006030180c, 0x18180cc6c67c0000, 0x0000000018180018,
	0xdedec6c67c000000, 0x000000007cc0dcde, 0xfec6c66c38100000, 0x00000000c6c6c6c6,
	0x667c666666fc0000, 0x00000000fc666666, 0xc0c0c0c2663c0000, 0x000000003c66c2c0,
	0x666666666cf80000, 0x00000000f86c6666, 0x6878686266fe0000, 0x00000000fe666260,
	0x6878686266fe0000, 0x00000000f0606060, 0xdec0c0c2663c0000, 0x000000003a66c6c6,
	0xc6fec6c6c6c60000, 0x00000000c6c6c6c6, 0x18181818183c0000, 0x000000003c181818,
	0x0c0c0c0c0c1e0000, 0x0000000078cccccc, 0x78786c6666e60000, 0x00000000e666666c,
	0x6060606060f00000, 0x00000000fe666260, 0xc6d6fefeeec60000, 0x00000000c6c6c6c6,
	0xcedefef6e6c60000, 0x00000000c6c6c6c6, 0xc6c6c6c6c67c0000, 0x000000007cc6c6c6,
	0x607c666666fc0000, 0x00000000f0606060, 0xc6c6c6c6c67c0000, 0x00000e0c7cded6c6,
	0x6c7c666666fc0000, 0x00000000e6666666, 0x0c3860c6c67c0000, 0x000000007cc6c606,
	0x1818185a7e7e0000, 0x000000003c181818, 0xc6c6c6c6c6c60000, 0x000000007cc6c6c6,
	0xc6c6c6c6c6c60000, 0x0000000010386cc6, 0xd6d6c6c6c6c60000, 0x000000006ceefed6,
	0x38387c6cc6c60000, 0x00000000c6c66c7c, 0x183c666666660000, 0x000000003c181818,
	0x30180c86c6fe0000, 0x00000000fec6c260, 0x30303030303c0000, 0x000000003c303030,
	0x3870e0c080000000, 0x0000000002060e1c, 0x0c0c0c0c0c3c0000, 0x000000003c0c0c0c,
	0x00000000c66c3810, 0x0000000000000000, 0x0000000000000000, 0x0000ff0000000000,
	0x0000000000183030, 0x0000000000000000, 0x7c0c780000000000, 0x0000000076cccccc,
	0x666c786060e00000, 0x000000007c666666, 0xc0c67c0000000000, 0x000000007cc6c0c0,
	0xcc6c3c0c0c1c0000, 0x0000000076cccccc, 0xfec67c0000000000, 0x000000007cc6c0c0,
	0x60f060646c380000, 0x00000000f0606060, 0xcccc760000000000, 0x0078cc0c7ccccccc,
	0x66766c6060e00000, 0x00000000e6666666, 0x1818380018180000, 0x000000003c181818,
	0x06060e0006060000, 0x003c666606060606, 0x786c666060e00000, 0x00000000e6666c78,
	0x1818181818380000, 0x000000003c181818, 0xd6feec0000000000, 0x00000000c6d6d6d6,
	0x6666dc0000000000, 0x0000000066666666, 0xc6c67c0000000000, 0x000000007cc6c6c6,
	0x6666dc0000000000, 0x00f060607c666666, 0xcccc760000000000, 0x001e0c0c7ccccccc,
	0x6676dc0000000000, 0x00000000f0606060, 0x60c67c0000000000, 0x000000007cc60c38,
	0x3030fc3030100000, 0x000000001c363030, 0xcccccc0000000000, 0x0000000076cccccc,
	0x6666660000000000, 0x00000000183c6666, 0xd6c6c60000000000, 0x000000006cfed6d6,
	0x386cc60000000000, 0x00000000c66c3838, 0xc6c6c60000000000, 0x00f80c067ec6c6c6,
	0x18ccfe0000000000, 0x00000000fec66030, 0x18701818180e0000, 0x000000000e181818,
	0x1818181818180000, 0x0000000018181818, 0x180e181818700000, 0x0000000070181818,
	0x00000000dc760000, 0x0000000000000000
};


const uint32_t terminusbold32x16[1520] = {
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x80038003, 0x80038003, 0x80038003, 0x80038003, 0x80038003,
	0x80038003, 0x00008003, 0x00000000, 0x80038003, 0x80038003, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x701c701c, 0x701c701c, 0x701c701c, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x701c701c, 0x701c701c, 0xfc7f701c, 0x701cfc7f, 0x701c701c,
	0x701c701c, 0xfc7f701c, 0x701cfc7f, 0x701c701c, 0x701c701c, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x80038003, 0xf01f8003, 0xbc7bf83f, 0x80739c73, 0x80738073, 0xf03f807b,
	0xbc03f81f, 0x9c039c03, 0x9c739c03, 0xf83fbc7b, 0x8003f01f, 0x80038003, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x9c3f1c1f, 0xb83bb83b, 0x701ff03f, 0xe000e000, 0xc001c001,
	0x80038003, 0x00070007, 0xfc0ff80e, 0xdc1ddc1d, 0xf838fc39, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xe01fc00f, 0x70387038, 0x70387038, 0xe01c7038, 0x800fc00f,
	0xee38ce1f, 0x38707c70, 0x38703870, 0x7c783870, 0xce1fee3f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x80038003, 0x80038003, 0x80038003, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xc001e000, 0x00078003, 0x000e0007, 0x000e000e, 0x000e000e,
	0x000e000e, 0x000e000e, 0x0007000e, 0x80030007, 0xe000c001, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x0007000e, 0xc0018003, 0xe000c001, 0xe000e000, 0xe000e000,
	0xe000e000, 0xe000e000, 0xc001e000, 0x8003c001, 0x000e0007, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x701c3838, 0xc007e00e, 0xfc7f8003,
	0x8003fc7f, 0xe00ec007, 0x3838701c, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x80038003, 0x80038003, 0xfc7f8003,
	0x8003fc7f, 0x80038003, 0x80038003, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x80038003, 0x80038003, 0x000e0007, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0xfc7f0000,
	0x0000fc7f, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x80038003, 0x80038003, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x1c001c00, 0x38003800, 0x70007000, 0xe000e000, 0xc001c001,
	0x80038003, 0x00070007, 0x000e000e, 0x001c001c, 0x00380038, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xf83ff01f, 0x1c703c78, 0x3c701c70, 0xfc707c70, 0x9c73dc71,
	0x1c7e1c77, 0x1c781c7c, 0x1c701c70, 0x3c781c70, 0xf01ff83f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x80078003, 0x801f800f, 0x8003801f, 0x80038003, 0x80038003,
	0x80038003, 0x80038003, 0x80038003, 0x80038003, 0xf01ff01f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xf83ff01f, 0x1c703c78, 0x1c701c70, 0x1c001c70, 0x70003800,
	0xc001e000, 0x00078003, 0x001c000e, 0x00700038, 0xfc7ffc7f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xf83ff01f, 0x1c703c78, 0x1c001c70, 0x1c001c00, 0xf80f3c00,
	0x3c00f80f, 0x1c001c00, 0x1c701c00, 0x3c781c70, 0xf01ff83f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x3c001c00, 0xfc007c00, 0x9c03dc01, 0x1c0e1c07, 0x1c381c1c,
	0x1c701c70, 0xfc7f1c70, 0x1c00fc7f, 0x1c001c00, 0x1c001c00, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xfc7ffc7f, 0x00700070, 0x00700070, 0x00700070, 0xf87ff07f,
	0x1c003c00, 0x1c001c00, 0x1c001c00, 0x1c781c70, 0xf01ff83f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xf83ff81f, 0x00700078, 0x00700070, 0x00700070, 0xf87ff07f,
	0x1c703c70, 0x1c701c70, 0x1c701c70, 0x3c781c70, 0xf01ff83f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xfc7ffc7f, 0x1c701c70, 0x38701c70, 0x70003800, 0xe0007000,
	0xc001e000, 0x8003c001, 0x80038003, 0x80038003, 0x80038003, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xf83ff01f, 0x1c703c78, 0x1c701c70, 0x1c701c70, 0xf83f3c78,
	0x3c78f83f, 0x1c701c70, 0x1c701c70, 0x3c781c70, 0xf01ff83f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xf83ff01f, 0x1c703c78, 0x1c701c70, 0x1c701c70, 0x1c781c70,
	0xfc1ffc3f, 0x1c001c00, 0x1c001c00, 0x3c001c00, 0xf03ff83f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x80038003, 0x80038003,
	0x00000000, 0x00000000, 0x00000000, 0x80038003, 0x80038003, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x80038003, 0x80038003,
	0x00000000, 0x00000000, 0x00000000, 0x80038003, 0x80038003, 0x000e0007, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x38001c00, 0xe0007000, 0x8003c001, 0x000e0007, 0x0038001c,
	0x001c0038, 0x0007000e, 0xc0018003, 0x7000e000, 0x1c003800, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0xfc7ffc7f, 0x00000000,
	0x00000000, 0xfc7ffc7f, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x001c0038, 0x0007000e, 0xc0018003, 0x7000e000, 0x1c003800,
	0x38001c00, 0xe0007000, 0x8003c001, 0x000e0007, 0x0038001c, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xf83ff01f, 0x1c703c78, 0x1c701c70, 0x38001c70, 0xe0007000,
	0x8003c001, 0x80038003, 0x00000000, 0x80038003, 0x80038003, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xfc3ff81f, 0x06700e78, 0xfe73fe71, 0x0e778e77, 0x0e770e77,
	0x0e770e77, 0x9e770e77, 0xf671fe73, 0x00780070, 0xfe1ffe3f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xf83ff01f, 0x1c703c78, 0x1c701c70, 0x1c701c70, 0x1c701c70,
	0xfc7ffc7f, 0x1c701c70, 0x1c701c70, 0x1c701c70, 0x1c701c70, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xf87ff07f, 0x1c703c70, 0x1c701c70, 0x38701c70, 0xf07ff07f,
	0x1c703870, 0x1c701c70, 0x1c701c70, 0x3c701c70, 0xf07ff87f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xf83ff01f, 0x1c703c78, 0x00701c70, 0x00700070, 0x00700070,
	0x00700070, 0x00700070, 0x1c700070, 0x3c781c70, 0xf01ff83f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xf07fc07f, 0x38707870, 0x1c701c70, 0x1c701c70, 0x1c701c70,
	0x1c701c70, 0x1c701c70, 0x1c701c70, 0x78703870, 0xc07ff07f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xfc7ffc7f, 0x00700070, 0x00700070, 0x00700070, 0xe07f0070,
	0x0070e07f, 0x00700070, 0x00700070, 0x00700070, 0xfc7ffc7f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xfc7ffc7f, 0x00700070, 0x00700070, 0x00700070, 0xe07f0070,
	0x0070e07f, 0x00700070, 0x00700070, 0x00700070, 0x00700070, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xf83ff01f, 0x1c703c78, 0x00701c70, 0x00700070, 0xfc710070,
	0x1c70fc71, 0x1c701c70, 0x1c701c70, 0x3c781c70, 0xf01ff83f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x1c701c70, 0x1c701c70, 0x1c701c70, 0x1c701c70, 0xfc7f1c70,
	0x1c70fc7f, 0x1c701c70, 0x1c701c70, 0x1c701c70, 0x1c701c70, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xe00fe00f, 0x80038003, 0x80038003, 0x80038003, 0x80038003,
	0x80038003, 0x80038003, 0x80038003, 0x80038003, 0xe00fe00f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xfe00fe00, 0x38003800, 0x38003800, 0x38003800, 0x38003800,
	0x38003800, 0x38003800, 0x38703870, 0x78783870, 0xe01ff03f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x1c700c70, 0x70703870, 0xc071e070, 0x00778073, 0x007c007e,
	0x007e007c, 0x80730077, 0xe070c071, 0x38707070, 0x0c701c70, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00700070, 0x00700070, 0x00700070, 0x00700070, 0x00700070,
	0x00700070, 0x00700070, 0x00700070, 0x00700070, 0xfc7ffc7f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x0e700e70, 0x3e7c1e78, 0x7e7e7e7e, 0xce73ee77, 0x8e71ce73,
	0x0e700e70, 0x0e700e70, 0x0e700e70, 0x0e700e70, 0x0e700e70, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x1c701c70, 0x1c701c70, 0x1c781c70, 0x1c7e1c7c, 0x9c731c77,
	0xfc70dc71, 0x3c707c70, 0x1c701c70, 0x1c701c70, 0x1c701c70, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xf83ff01f, 0x1c703c78, 0x1c701c70, 0x1c701c70, 0x1c701c70,
	0x1c701c70, 0x1c701c70, 0x1c701c70, 0x3c781c70, 0xf01ff83f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xf87ff07f, 0x1c703c70, 0x1c701c70, 0x1c701c70, 0x3c701c70,
	0xf07ff87f, 0x00700070, 0x00700070, 0x00700070, 0x00700070, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xf83ff01f, 0x1c703c78, 0x1c701c70, 0x1c701c70, 0x1c701c70,
	0x1c701c70, 0x1c701c70, 0x1c701c70, 0xfc799c73, 0xf01ff83f, 0x1c003800, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xf87ff07f, 0x1c703c70, 0x1c701c70, 0x1c701c70, 0x3c701c70,
	0xf07ff87f, 0x0077007e, 0xc0718073, 0x7070e070, 0x1c703870, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xf83ff01f, 0x1c703c78, 0x00701c70, 0x00700070, 0xf03f0078,
	0x3c00f81f, 0x1c001c00, 0x1c701c00, 0x3c781c70, 0xf01ff83f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xfc7ffc7f, 0x80038003, 0x80038003, 0x80038003, 0x80038003,
	0x80038003, 0x80038003, 0x80038003, 0x80038003, 0x80038003, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x1c701c70, 0x1c701c70, 0x1c701c70, 0x1c701c70, 0x1c701c70,
	0x1c701c70, 0x1c701c70, 0x1c701c70, 0x3c781c70, 0xf01ff83f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x1c701c70, 0x1c701c70, 0x38381c70, 0x38383838, 0x38383838,
	0x701c701c, 0x701c701c, 0xe00ee00e, 0xc007e00e, 0xc007c007, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x0e700e70, 0x0e700e70, 0x0e700e70, 0x0e700e70, 0x0e700e70,
	0xce738e71, 0xee77ce73, 0x7e7e7e7e, 0x1e783e7c, 0x0e700e70, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x1c701c70, 0x38383838, 0x701c701c, 0xe00ee00e, 0xc007c007,
	0xc007c007, 0xe00ee00e, 0x701c701c, 0x38383838, 0x1c701c70, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x1c701c70, 0x38381c70, 0x701c3838, 0xe00e701c, 0xc007e00e,
	0x8003c007, 0x80038003, 0x80038003, 0x80038003, 0x80038003, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xfc7ffc7f, 0x1c001c00, 0x38001c00, 0xe0007000, 0x8003c001,
	0x000e0007, 0x0038001c, 0x00700070, 0x00700070, 0xfc7ffc7f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xf00ff00f, 0x000e000e, 0x000e000e, 0x000e000e, 0x000e000e,
	0x000e000e, 0x000e000e, 0x000e000e, 0x000e000e, 0xf00ff00f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00380038, 0x001c001c, 0x000e000e, 0x00070007, 0x80038003,
	0xc001c001, 0xe000e000, 0x70007000, 0x38003800, 0x1c001c00, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xf00ff00f, 0x70007000, 0x70007000, 0x70007000, 0x70007000,
	0x70007000, 0x70007000, 0x70007000, 0x70007000, 0xf00ff00f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0xc0078003, 0x701ce00e, 0x1c703838, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0xfc7f0000, 0x0000fc7f, 0x00000000,
	0x001c0000, 0x0007000e, 0x00008003, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0xf83ff03f, 0x1c003c00,
	0xfc1f1c00, 0x1c78fc3f, 0x1c701c70, 0x1c781c70, 0xfc1ffc3f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00700070, 0x00700070, 0x00700070, 0xf87ff07f, 0x1c703c70,
	0x1c701c70, 0x1c701c70, 0x1c701c70, 0x3c701c70, 0xf07ff87f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0xf83ff01f, 0x1c703c78,
	0x00700070, 0x00700070, 0x00700070, 0x3c781c70, 0xf01ff83f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x1c001c00, 0x1c001c00, 0x1c001c00, 0xfc3ffc1f, 0x1c701c78,
	0x1c701c70, 0x1c701c70, 0x1c701c70, 0x1c781c70, 0xfc1ffc3f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0xf83ff01f, 0x1c703c78,
	0x1c701c70, 0xfc7ffc7f, 0x00700070, 0x1c780070, 0xf81ffc3f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xfe01fe00, 0x8003c003, 0x80038003, 0xf83ff83f, 0x80038003,
	0x80038003, 0x80038003, 0x80038003, 0x80038003, 0x80038003, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0xfc3ffc1f, 0x1c701c78,
	0x1c701c70, 0x1c701c70, 0x1c701c70, 0x1c781c70, 0xfc1ffc3f, 0x1c001c00, 0xf83f3c00, 0x0000f03f,
	0x00000000, 0x00000000, 0x00000000, 0x00700070, 0x00700070, 0x00700070, 0xf87ff07f, 0x1c703c70,
	0x1c701c70, 0x1c701c70, 0x1c701c70, 0x1c701c70, 0x1c701c70, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x80038003, 0x80038003, 0x00000000, 0x800f800f, 0x80038003,
	0x80038003, 0x80038003, 0x80038003, 0x80038003, 0xe00fe00f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x38003800, 0x38003800, 0x00000000, 0xf800f800, 0x38003800,
	0x38003800, 0x38003800, 0x38003800, 0x38003800, 0x38003800, 0x38383838, 0xf01f783c, 0x0000e00f,
	0x00000000, 0x00000000, 0x00000000, 0x00380038, 0x00380038, 0x00380038, 0x38381c38, 0xe0387038,
	0x803bc039, 0x003f003f, 0xc039803b, 0x7038e038, 0x1c383838, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x800f800f, 0x80038003, 0x80038003, 0x80038003, 0x80038003,
	0x80038003, 0x80038003, 0x80038003, 0x80038003, 0xe00fe00f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0xf87ff07f, 0x9c73bc73,
	0x9c739c73, 0x9c739c73, 0x9c739c73, 0x9c739c73, 0x9c739c73, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0xf87ff07f, 0x1c703c70,
	0x1c701c70, 0x1c701c70, 0x1c701c70, 0x1c701c70, 0x1c701c70, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0xf83ff01f, 0x1c703c78,
	0x1c701c70, 0x1c701c70, 0x1c701c70, 0x3c781c70, 0xf01ff83f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0xf87ff07f, 0x1c703c70,
	0x1c701c70, 0x1c701c70, 0x1c701c70, 0x3c701c70, 0xf07ff87f, 0x00700070, 0x00700070, 0x00000070,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0xfc3ffc1f, 0x1c701c78,
	0x1c701c70, 0x1c701c70, 0x1c701c70, 0x1c781c70, 0xfc1ffc3f, 0x1c001c00, 0x1c001c00, 0x00001c00,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0xfc77fc73, 0x007c007e,
	0x00700078, 0x00700070, 0x00700070, 0x00700070, 0x00700070, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0xf83ff01f, 0x00703c78,
	0x00780070, 0xf81ff03f, 0x1c003c00, 0x3c781c00, 0xf01ff83f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00070007, 0x00070007, 0x00070007, 0xf07ff07f, 0x00070007,
	0x00070007, 0x00070007, 0x00070007, 0x80070007, 0xfc01fc03, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x1c701c70, 0x1c701c70,
	0x1c701c70, 0x1c701c70, 0x1c701c70, 0x1c781c70, 0xfc1ffc3f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x1c701c70, 0x38381c70,
	0x38383838, 0x701c701c, 0xe00e701c, 0xc007e00e, 0xc007c007, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x1c701c70, 0x1c701c70,
	0x9c739c73, 0x9c739c73, 0x9c739c73, 0xbc7b9c73, 0xf01ff83f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x1c701c70, 0x38381c70,
	0xe00e701c, 0xc007c007, 0x701ce00e, 0x1c703838, 0x1c701c70, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x1c701c70, 0x1c701c70,
	0x1c701c70, 0x1c701c70, 0x1c701c70, 0x1c781c70, 0xfc1ffc3f, 0x1c001c00, 0xf83f3c00, 0x0000f03f,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0xfc7ffc7f, 0x70003800,
	0xc001e000, 0x00078003, 0x001c000e, 0x00700038, 0xfc7ffc7f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0xf003f001, 0x00078007, 0x00070007, 0x00070007, 0x003e0007,
	0x0007003e, 0x00070007, 0x00070007, 0x80070007, 0xf001f003, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x80038003, 0x80038003, 0x80038003, 0x80038003, 0x80038003,
	0x80038003, 0x80038003, 0x80038003, 0x80038003, 0x80038003, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x003f003e, 0x80038007, 0x80038003, 0x80038003, 0xf0018003,
	0x8003f001, 0x80038003, 0x80038003, 0x80078003, 0x003e003f, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x1c1e0000, 0x9c771c3f,
	0xf871dc73, 0x0000f070, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000
};


/* return previous_color*(1-alpha) + new_color*alpha */
static uint32_t mix_colors(uint32_t previous_color, uint32_t new_color)
{
	uint32_t alpha = new_color >> 24;
	if (alpha > 0) alpha += 1;
	uint32_t one_minus_alpha = 256 - alpha;
	uint32_t r = ((((previous_color >> 16) & 0xff) * one_minus_alpha) >> 8) + ((((new_color >> 16) & 0xff) * alpha) >> 8);
	uint32_t g = ((((previous_color >>  8) & 0xff) * one_minus_alpha) >> 8) + ((((new_color >>  8) & 0xff) * alpha) >> 8);
	uint32_t b = ((((previous_color >>  0) & 0xff) * one_minus_alpha) >> 8) + ((((new_color >>  0) & 0xff) * alpha) >> 8);
	return 0xff000000 | (r << 16) | (g << 8) | b;
}


void font_8x16_draw_char(int x, int y, char c, uint32_t color_on, uint32_t color_off)
{
	const int screen_width  = VIDEO->WIDTH;
	const int screen_height = VIDEO->HEIGHT;
	uint32_t *framebuffer   = (uint32_t*)VIDEO->DMA_ADDR;
	if (x >= screen_width || y >= screen_width || x + 8 <= 0 || y + 16 <= 0)
		return;
	if (c < ' ' || c > '~')
		c = ' ';
	const uint8_t *font = (uint8_t*)Uni2VGA16;
	const uint8_t *glyph = &font[((int)c - 32) * 16];
	int ystart = y;
	int yc = 0;
	if (y < 0) {
		ystart = 0;
		yc = -y;
	}
	int ystop  = (y + 16) > screen_height ? screen_height : (y + 16);
	int xstart = x;
	int xc = 0;
	if (x < 0) {
		xstart = 0;
		xc = -x;
	}
	int xstop  = (x + 8) > screen_width ? screen_width : (x + 8);
	uint32_t alpha_on  = color_on >> 24;
	int alpha_on_full  = (alpha_on == 255);
	int alpha_on_zero  = (alpha_on ==   0);
	uint32_t alpha_off = color_off >> 24;
	int alpha_off_full = (alpha_off == 255);
	int alpha_off_zero = (alpha_off ==   0);
	if (alpha_on_full && alpha_off_full) {
		for (y = ystart; y < ystop; y++) {
			uint8_t gl = glyph[yc++];
			int p = xc;
			for (x = xstart; x < xstop; x++) {
				if ((gl << p++) & 0x80) { // pixel on
					framebuffer[y*screen_width+x] = color_on;
				} else { // pixel off
					framebuffer[y*screen_width+x] = color_off;
				}
			}
		}
	} else if (alpha_on_full && alpha_off_zero) {
		for (y = ystart; y < ystop; y++) {
			uint8_t gl = glyph[yc++];
			int p = xc;
			for (x = xstart; x < xstop; x++) {
				if ((gl << p++) & 0x80) { // pixel on
					framebuffer[y*screen_width+x] = color_on;
				}
			}
		}
	} else if (alpha_on_zero && alpha_off_full) {
		for (y = ystart; y < ystop; y++) {
			uint8_t gl = glyph[yc++];
			int p = xc;
			for (x = xstart; x < xstop; x++) {
				if (((gl << p++) & 0x80) == 0) { // pixel on
					framebuffer[y*screen_width+x] = color_off;
				}
			}
		}
	} else {
		for (y = ystart; y < ystop; y++) {
			uint8_t gl = glyph[yc++];
			int p = xc;
			for (x = xstart; x < xstop; x++) {
				if ((gl << p++) & 0x80) { // pixel on
					if (alpha_on_full) {
						framebuffer[y*screen_width+x] = color_on;
					} else if (!alpha_on_zero) {
						framebuffer[y*screen_width+x] = mix_colors(framebuffer[y*screen_width+x], color_on);
					}
				} else { // pixel off
					if (alpha_off_full) {
						framebuffer[y*screen_width+x] = color_off;
					} else if (!alpha_off_zero) {
						framebuffer[y*screen_width+x] = mix_colors(framebuffer[y*screen_width+x], color_off);
					}
				}
			}
		}
	}
}


int font_8x16_draw_text(int x, int y, const char *str, uint32_t color_on, uint32_t color_off)
{
	char c;
	int r = 0;
	int xstart = x;
	while ((c = *str++) != '\0') {
		if (c == '\r') {
			x = xstart;
		} else if (c == '\n') {
			x = xstart;
			y += 16;
		} else {
			font_8x16_draw_char(x, y, c, color_on, color_off);
			x += 8;
			r++;
		}
	}
	return r;
}


void font_16x32_draw_char(int x, int y, char c, uint32_t color_on, uint32_t color_off)
{
	const int screen_width  = VIDEO->WIDTH;
	const int screen_height = VIDEO->HEIGHT;
	uint32_t *framebuffer   = (uint32_t*)VIDEO->DMA_ADDR;
	if (x >= screen_width || y >= screen_width || (x + 16) <= 0 || (y + 32) <= 0)
		return;
	if (c < ' ' || c > '~')
		c = ' ';
	const uint16_t *font = (uint16_t*)terminusbold32x16;
	const uint16_t *glyph = &font[((int)c - ' ') * 32];
	int ystart = y;
	int yc = 0;
	if (y < 0) {
		ystart = 0;
		yc = -y;
	}
	int ystop  = (y + 32) > screen_height ? screen_height : (y + 32);
	int xstart = x;
	int xc = 0;
	if (x < 0) {
		xstart = 0;
		xc = -x;
	}
	int xstop  = (x + 16) > screen_width ? screen_width : (x + 16);
	uint32_t alpha_on  = color_on >> 24;
	int alpha_on_full  = (alpha_on == 255);
	int alpha_on_zero  = (alpha_on ==   0);
	uint32_t alpha_off = color_off >> 24;
	int alpha_off_full = (alpha_off == 255);
	int alpha_off_zero = (alpha_off ==   0);
	if (alpha_on_full && alpha_off_full) {
		for (y = ystart; y < ystop; y++) {
			uint16_t gl = glyph[yc++];
			gl = (gl >> 8) | (gl << 8);
			int p = xc;
			for (x = xstart; x < xstop; x++) {
				if ((gl << p++) & 0x8000) { // pixel on
					framebuffer[y*screen_width+x] = color_on;
				} else { // pixel off
					framebuffer[y*screen_width+x] = color_off;
				}
			}
		}
	} else if (alpha_on_full && alpha_off_zero) {
		for (y = ystart; y < ystop; y++) {
			uint16_t gl = glyph[yc++];
			gl = (gl >> 8) | (gl << 8);
			int p = xc;
			for (x = xstart; x < xstop; x++) {
				if ((gl << p++) & 0x8000) { // pixel on
					framebuffer[y*screen_width+x] = color_on;
				}
			}
		}
	} else if (alpha_on_zero && alpha_off_full) {
		for (y = ystart; y < ystop; y++) {
			uint16_t gl = glyph[yc++];
			gl = (gl >> 8) | (gl << 8);
			int p = xc;
			for (x = xstart; x < xstop; x++) {
				if (((gl << p++) & 0x8000) == 0) { // pixel off
					framebuffer[y*screen_width+x] = color_off;
				}
			}
		}
	} else {
		for (y = ystart; y < ystop; y++) {
			uint16_t gl = glyph[yc++];
			gl = (gl >> 8) | (gl << 8);
			int p = xc;
			for (x = xstart; x < xstop; x++) {
				if ((gl << p++) & 0x8000) { // pixel on
					if (alpha_on_full) {
						framebuffer[y*screen_width+x] = color_on;
					} else if (!alpha_on_zero) {
						framebuffer[y*screen_width+x] = mix_colors(framebuffer[y*screen_width+x], color_on);
					}
				} else { // pixel off
					if (alpha_off_full) {
						framebuffer[y*screen_width+x] = color_off;
					} else if (!alpha_off_zero) {
						framebuffer[y*screen_width+x] = mix_colors(framebuffer[y*screen_width+x], color_off);
					}
				}
			}
		}
	}
}


int font_16x32_draw_text(int x, int y, const char *str, uint32_t color_on, uint32_t color_off)
{
	char c;
	int r = 0;
	int xstart = x;
	while ((c = *str++) != '\0') {
		if (c == '\r') {
			x = xstart;
		} else if (c == '\n') {
			x = xstart;
			y += 32;
		} else {
			font_16x32_draw_char(x, y, c, color_on, color_off);
			x += 16;
			r++;
		}
	}
	return r;
}


